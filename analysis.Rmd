---
title: "GPL"
author: "Grant Mitchell"
date: "2024-06-04"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Last updated: 3/22/2024

This code runs the analysis for my paper, Populist Paths to Autocracy. It uses data cleaned by the author to test an interaction effect between populist discourse and an index of several party organization indicators on the quality of democracy. I take several indicators of democratic quality and run OLS, Bayesian regressions, General Additive Models, and Fixed-Effects models to test this interaction.

A this guide may have changed since I last updated this code, but in general, you will find the start of each section at these page numbers:

Background info - page 1

Model Selection and Assumptions - page 2-96

Cross Validation - 96-99

Interactions and Assumptions - 99-123

Clustered and FE Model - 123-168

Tables and Visuals- 168-191

The logic behind why specific party structures moderate the effect of populist discourse is fleshed out in the paper, but I will give a summary here. While the discourse of populist leaders betrays their motive to harm liberal democracy, it does not explain the capacity of those leaders. This has resulted in the heterogeneous effect of populist discourse. Some leaders take over democracy and suffocate it, while others fail to live out their term. This is the case for two reasons. First, populists require consistent broad support as they unravel democratic institutions. This support is far from assured. Second, populists must have a unified party to insulate them from elite attacks. Given the personalistic style many populist leaders use, this is also not a given. As such, populists need the means to ensure broad support (I theorize that this is mass patronage and a intial poor economy) and a unified party. When populists have all these factors, they can erode democracy. When they do not, they fall short and are removed from office. The data set I use merges several data sets to test my theory. I draw from Quality of Governance, Varieties of Democracy and Party, the Standardized World Income Inequality Database, the World Bank, and the Global Populism Database.

Here is a guide for understanding the variables in this analysis.

populismavg - the intensity of a leader's populist rhetoric. This variable is logged. Higher values mean more populism.

icap - the incumbent capacity index, created by taking the average of (1/3) V-Party's internal cohesion, (1/3) clientelism, (1/6)income inequality, and changes in (1/6) unemployment. Higher means more capacity. The term of interest is the interaction between this index and populism.

lngdppc - logged GDP per capita at y0 (the year before a leader takes office).

lndemocexp - logged years of democratic experience (polyarchy \>= .42)

lnseatshare - logged seat share of leaders party at y0.

lnyear - logged years in office for consecutive term/s.

polyarchy - V-Dem electoral democracy score. There are t0 and chg versions.

frefair - V-Dem electoral integraty score. There are t0 and chg versions.

civlib - V-Dem political rights score. There are t0 and chg versions.

horacc - V-Dem horizontal accountability score. There are t0 and chg versions.

op_strength - the V-Party grassroots organization measure for the largest opposition party.

lnopseatshare - logged seat share for the largest opposition party

The format for this code followsâ€”first, load the packages. Make sure to have all of the packages necessary to run the script. Not all of the packages used are loaded here. I also use the corrplot and car packages for specific lines of code. Make sure to install those as well.

Proceed to model selection and checking OLS assumptions for the various models. It moves through the analysis by the dependent variable: polyarchy/electoral democracy, free and fair elections, civil liberties, and horizontal accountability.

The next step is cross-validation using Bayesian Leave One Out Analysis (LOO). The order proceeds in the same way as before.

The script then checks the interaction effect for each model in 3 ways: General Additive Model, Linear interaction, and Kernel interaction (see Heinmuller et al. 2019).

It then runs models with Clustered standard errors and Fixed Effects. Redone interactions with FE follow these models.

All data was cleaned by the author in STATA.

## Load packages

```{r, include=FALSE}
library(tidyverse)
library(haven)
library(ggfortify)
library(ggthemes)
library(GGally)
library(rstanarm)
library(miceadds)
library(sandwich)
library(estimatr)
library(bestglm)
library(interflex)
library(stargazer)
```

### Polyarchy Model selection

#### Read in the data

```{r}
gpl <- read_dta("C:/Users/ochoc/Dropbox/Populism Projects/GPL data/gpl_2023.dta") %>%
  rename(lnopseatshare = lnopseatahre)
  #select(!icap) %>%
  #mutate(icap = (st_cohesion + st_patron)/2)

varis <- gpl %>%
  filter(polyarchy_t0 >= .42) %>%
  select(lnseatshare, lndemocexp, lngdppc, polyarchy_t0, icap, populismavg, op_strength, lnyears, polyarchy_chg, lnopseatshare) %>%
  na.omit() #### for every model, only regimes with a starting score of >= .42 are considered because this is the new V-Dem threshold.

attach(varis)
```

#### Visualize data

Correlation Matrix

```{r}
corrplot::corrplot(cor(varis))
```

GGpairs plot

```{r}
ggpairs(varis)
```

#### Model selection

We are interested in the interaction between populism (logged) and incumbent capacity, so we include the intercaction in all the models. For this reason we use stepwise selection instead of best subsets or LASSO.

```{r}
base_mod <- glm(polyarchy_chg ~ populismavg*icap) 

full_mod <- glm(polyarchy_chg ~ populismavg*icap + lnseatshare + lndemocexp + lnyears + lngdppc + polyarchy_t0 + op_strength + lnopseatshare)

#### Forward

step_forward_aic <- step(base_mod,
                      direction = "forward",
                      k = 2,
                      scope=list(lower= base_mod, upper= full_mod))


step_forward_bic <- step(base_mod,
                      direction = "forward",
                      k = log(nrow(varis)),
                      scope=list(lower= base_mod, upper= full_mod))

#### Backward

step_back_aic <- step(full_mod,
                      direction = "back",
                      k = 2,
                      scope=list(lower= base_mod, upper= full_mod))

step_back_bic <- step(full_mod,
                      direction = "back",
                      k = log(nrow(varis)),
                      scope=list(lower= base_mod, upper= full_mod))

#### Both

step_both_aic <- step(base_mod,
                      direction = "both",
                      k = 2,
                      scope=list(lower= base_mod, upper= full_mod))

step_both_bic <- step(base_mod,
                      direction = "both",
                      k = log(nrow(varis)),
                      scope=list(lower= base_mod, upper= full_mod))

```

Compare formulas

```{r}
step_forward_aic$formula
step_forward_bic$formula
step_back_aic$formula
step_back_bic$formula
step_both_aic$formula
step_both_bic$formula
```

I'll use 2 formulas here:

Theoretical/full model. This model includes all of the variables I have considered when think about alternative explinations. It is likely over fitted, but the model that most social scientists are most interested in.

```{r}
f2 <- polyarchy_chg ~ populismavg*icap + lnseatshare + lndemocexp + lnyears+ lngdppc + polyarchy_t0 + op_strength + lnopseatshare
```

Simple/Parsimonious Model. This model balances the theoretically important variables and a simple model with low BIC/AIC. This is the logic I follow for the rest of the model selection processes.

```{r}
f1 <- step_both_aic$formula 
```

## Running the OLS Models

### Simple Model

```{r}
varis <- gpl %>% 
  filter(polyarchy_t0 >= .42) %>% 
  select(leader, lnseatshare, lndemocexp, lnyears, lngdppc, polyarchy_t0, polyarchy_chg, icap, populismavg, cow, op_strength, lnopseatshare)
attach(varis)

m1 <- lm(f1)
```

#### Check assumptions

```{r}

##### Linearity

autoplot(m1, which = 1, nrows = 1, ncols = 1)#### not bad

#### Normality

autoplot(m1, which = 2, nrows = 1, ncols = 1)#### does not look great, but not terrible
hist(m1$residuals, freq = F) #### not bad, not good.

#### Constant Variance

autoplot(m1, which = 3, nrows = 1, ncols = 1) #### bad, but this is likely because the errors need to be clustered by country. This also might cause come non-linearity.

#### Cooks Distance

autoplot(m1, which = 4, nrows = 1, ncols = 1) #### some outlines, not a ton. Nothing above .5. Leave as is.

car::vif(m1, type = "predictor") #### Looks good
```

Check the results

```{r}
summary(m1) #### Interaction is sig at .001
```

### Full Model

```{r}
m2 <- lm(f2)

#### Linearity

autoplot(m2, which = 1, nrows = 1, ncols = 1) #### not good,but I've seen worse

#### Normality

autoplot(m2, which = 2, nrows = 1, ncols = 1)#### does not look great, but not terrible 
hist(m2$residuals, freq = F) #### not bad, not good

#### Constant Variance

autoplot(m2, which = 3, nrows = 1, ncols = 1) #### not a surprise, we need to cluster SE's

#### Cooks Distance

autoplot(m2, which = 4, nrows = 1, ncols = 1) #### Noting above .5. Leave as is.

car::vif(m2, type = "predictor") #### Looks good
```

Check Results

```{r}
summary(m2) #### Interaction sig at .001
```

## Free and Fair elections

```{r}
varis <- gpl %>% 
  filter(polyarchy_t0 >= .42) %>% 
  select(lnseatshare, lndemocexp, lnyears, lngdppc, frefair_t0, frefair_chg, icap, populismavg, op_strength, lnopseatshare) %>% 
  na.omit() 
attach(varis)
```

#### Visualize data

```{r}
corrplot::corrplot(cor(varis))

ggpairs(varis)
```

#### Model selection

```{r}

base_mod <- glm(frefair_chg ~ populismavg*icap)

full_mod <- glm(frefair_chg ~ populismavg*icap + lnseatshare + lndemocexp + lnyears+ lngdppc + frefair_t0 + op_strength + lnopseatshare)

#### Forward

step_forward_aic <- step(base_mod, direction = "forward", k = 2, scope=list(lower= base_mod, upper= full_mod))

step_forward_bic <- step(base_mod, direction = "forward", k = log(nrow(varis)), scope=list(lower= base_mod, upper= full_mod))

#### Backward

step_back_aic <- step(full_mod, direction = "back", k = 2, scope=list(lower= base_mod, upper= full_mod))

step_back_bic <- step(full_mod, direction = "back", k = log(nrow(varis)), scope=list(lower= base_mod, upper= full_mod))

#### Both

step_both_aic <- step(base_mod, direction = "both", k = 2, scope=list(lower= base_mod, upper= full_mod))

step_both_bic <- step(base_mod, direction = "both", k = log(nrow(varis)), scope=list(lower= base_mod, upper= full_mod))
```

#### Compare formulas

```{r}
step_forward_aic$formula 
step_forward_bic$formula 
step_back_aic$formula 
step_back_bic$formula 
step_both_aic$formula 
step_both_bic$formula
```

Theoretical/full model

```{r}
f4 <- frefair_chg ~ populismavg*icap + lnseatshare + lndemocexp + lnyears+ lngdppc + frefair_t0 + op_strength + lnopseatshare 
```

Simple/Parsimonious Model

```{r}
f3 <- step_both_bic$formula
```

### Models

#### Simple Model

```{r}
varis <- gpl %>% 
  filter(polyarchy_t0 >= .42) %>% 
  select(lnseatshare, lndemocexp, lnyears, lngdppc, frefair_t0, frefair_chg, icap, populismavg, cow, op_strength, lnopseatshare)
attach(varis)


m3 <- lm(f3)
```

#### Check assumptions

```{r}
#### Linearity

autoplot(m3, which = 1, nrows = 1, ncols = 1) #### not bad

#### Normality

autoplot(m3, which = 2, nrows = 1, ncols = 1)#### does not look great, but not terrible
hist(m3$residuals, freq = F) #### like before, not bad, not good

#### Constant Variance

autoplot(m3, which = 3, nrows = 1, ncols = 1) #### Cluster the SEs

#### Cooks Distance

autoplot(m3, which = 4, nrows = 1, ncols = 1) #### some outlines, not a ton. Still none above .5, so leave as the same.

car::vif(m3, type = "predictor") #### Looks good
```

Check the results

```{r}
summary(m3) #### interaction Significant at .01
```

#### Full model

```{r}
m4 <- lm(f4)

#### Linearity

autoplot(m4, which = 1, nrows = 1, ncols = 1) #### not good, but I've seen worse

#### Normality

autoplot(m4, which = 2, nrows = 1, ncols = 1)#### does not look great, but not terrible \
hist(m4$residuals, freq = F) #### not bad, not good. there appears to be observations with really big residuals.

#### Constant Variance

autoplot(m4, which = 3, nrows = 1, ncols = 1) #### not a surprise, we need to cluster SE's

#### Cooks Distance

autoplot(m4, which = 4, nrows = 1, ncols = 1) #### the big outliar did not have a super large cooks d, so we leave it as it.

car::vif(m4, type = "predictor") #### looks good.
```

Check Results

```{r}
summary(m4) #### term sig at 0.01
```

## Civil Liberties

```{r}
varis <- gpl %>% 
  filter(polyarchy_t0 >= .42) %>% 
  select(lnseatshare, lndemocexp, lnyears, lngdppc, civlib_t0, civlib_chg, icap, populismavg, op_strength, lnopseatshare) %>% 
  na.omit() 
attach(varis)
```

#### Visualize data

```{r}
corrplot::corrplot(cor(varis))

ggpairs(varis)
```

### Model selection

```{r, include=FALSE}
base_mod <- glm(civlib_chg ~ populismavg*icap)

full_mod <- glm(civlib_chg ~ populismavg*icap + lnseatshare + lndemocexp + lnyears+ lngdppc + civlib_t0 + op_strength + lnopseatshare)

#### Forward

step_forward_aic <- step(base_mod, direction = "forward", k = 2, scope=list(lower= base_mod, upper= full_mod))

step_forward_bic <- step(base_mod, direction = "forward", k = log(nrow(varis)), scope=list(lower= base_mod, upper= full_mod))

#### Backward

step_back_aic <- step(full_mod, direction = "back", k = 2, scope=list(lower= base_mod, upper= full_mod))

step_back_bic <- step(full_mod, direction = "back", k = log(nrow(varis)), scope=list(lower= base_mod, upper= full_mod))

#### Both

step_both_aic <- step(base_mod, direction = "both", k = 2, scope=list(lower= base_mod, upper= full_mod))

step_both_bic <- step(base_mod, direction = "both", k = log(nrow(varis)), scope=list(lower= base_mod, upper= full_mod))
```

Compare formulas

```{r}
step_forward_aic$formula 
step_forward_bic$formula 
step_back_aic$formula 
step_back_bic$formula 
step_both_aic$formula 
step_both_bic$formula
```

Theoretical/full model

```{r}
f6 <- civlib_chg ~ populismavg*icap + lnseatshare + lndemocexp + lnyears+ lngdppc + civlib_t0 + op_strength + lnopseatshare
```

Simple/Parsimonious Model

```{r}
f5 <- step_both_aic$formula
```

### Models

#### Simple Model

```{r}
varis <- gpl %>% 
  filter(polyarchy_t0 >= .42) %>% 
  select(leader, lnseatshare, lndemocexp, lnyears, lngdppc, civlib_t0, civlib_chg, icap, populismavg, cow, op_strength, lnopseatshare) 
attach(varis)

m5 <- lm(f5)
```

#### Check assumptions

#### Linearity

```{r}
autoplot(m5, which = 1, nrows = 1, ncols = 1) #### not bad. this seems to be on par with the rest

#### Normality

autoplot(m5, which = 2, nrows = 1, ncols = 1)#### does not look great, but not terrible. 30 might need to go. 
hist(m5$residuals, freq = F) #### There seems to be some big outliers, we might need to drop some values

#### Constant Variance

autoplot(m5, which = 3, nrows = 1, ncols = 1) #### Need to cluster SEs

#### Cooks Distance

autoplot(m5, which = 4, nrows = 1, ncols = 1) #### 30 is high but good enough that we wont drop it.

car::vif(m5, type = "predictor") #### Looks good.
```

Check results

```{r}
summary(m5) #### sig at .001
```

#### Full Model/Theoretically Complex Model

```{r}
m6 <- lm(f6)

#### Linearity

autoplot(m6, which = 1, nrows = 1, ncols = 1) #### okay

#### Normality

autoplot(m6, which = 2, nrows = 1, ncols = 1)#### We will drop the 30th obs, so this would look better.

hist(m6$residuals, freq = F) #### same here

#### Constant Variance

autoplot(m6, which = 3, nrows = 1, ncols = 1) #### Cluster SEs

#### Cooks Distance

autoplot(m6, which = 4, nrows = 1, ncols = 1) #### Slightly better than the simple model.

car::vif(m6, type = "predictor") #### Looks good
```

Check results

```{r}
summary(m6) #### Sig at .001
```

#### Horizontal Accountability

```{r}
varis <- gpl %>% 
  filter(polyarchy_t0 >= .42) %>% 
  select(lnseatshare, lndemocexp, lnyears, lngdppc, horacc_t0, horacc_chg, icap, populismavg, op_strength, lnopseatshare) %>% 
  na.omit()
attach(varis)
```

#### Visualize data

```{r}
corrplot::corrplot(cor(varis))

ggpairs(varis)
```

#### Model selection

```{r}
base_mod <- glm(horacc_chg ~ populismavg*icap)

full_mod <- glm(horacc_chg ~ populismavg*icap + lnseatshare + lndemocexp + lnyears+ lngdppc + horacc_t0 + op_strength + lnopseatshare)

#### Forward

step_forward_aic <- step(base_mod, direction = "forward", k = 2, scope=list(lower= base_mod, upper= full_mod))

step_forward_bic <- step(base_mod, direction = "forward", k = log(nrow(varis)), scope=list(lower= base_mod, upper= full_mod))

#### Backward

step_back_aic <- step(full_mod, direction = "back", k = 2, scope=list(lower= base_mod, upper= full_mod))

step_back_bic <- step(full_mod, direction = "back", k = log(nrow(varis)), scope=list(lower= base_mod, upper= full_mod))

#### Both

step_both_aic <- step(base_mod, direction = "both", k = 2, scope=list(lower= base_mod, upper= full_mod))

step_both_bic <- step(base_mod, direction = "both", k = log(nrow(varis)), scope=list(lower= base_mod, upper= full_mod))
```

Compare formulas

```{r}
step_forward_aic$formula 
step_forward_bic$formula 
step_back_aic$formula 
step_back_bic$formula 
step_both_aic$formula 
step_both_bic$formula
```

Theoretical/full model

```{r}
f8 <- horacc_chg ~ populismavg*icap + lnseatshare + lndemocexp + lnyears+ lngdppc + horacc_t0 + op_strength + lnopseatshare
```

Simple Model

```{r}
f7 <- step_back_aic$formula
```

### Models

#### Simple Model

```{r}
varis <- gpl %>% 
  filter(polyarchy_t0 >= .42) %>% 
  select(leader, lnseatshare, lndemocexp, lnyears, lngdppc, horacc_t0, horacc_chg, icap, populismavg, cow, op_strength, lnopseatshare) 
attach(varis)

m7 <- lm(f7)
```

#### Check assumptions

```{r}
#### Linearity

autoplot(m7, which = 1, nrows = 1, ncols = 1) #### really good

#### Normality

autoplot(m7, which = 2, nrows = 1, ncols = 1)#### does not look great. We may need to drop 42.

hist(m7$residuals, freq = F) #### not bad, not good

#### Constant Variance

autoplot(m7, which = 3, nrows = 1, ncols = 1) #### pretty good considering we need to cluster by SE.

#### Cooks Distance

autoplot(m7, which = 4, nrows = 1, ncols = 1) #### We need to drop obs 42

car::vif(m7, type = "predictor") #### looks good
```

Check results

```{r}
summary(m7) #### Sig at .01
```

#### Full Model/Theoretically Complex Model

```{r}
m8 <- lm(f8)

#### Linearity

autoplot(m8, which = 1, nrows = 1, ncols = 1) #### Good

#### Normality

autoplot(m8, which = 2, nrows = 1, ncols = 1)#### Drop 42

hist(m8$residuals, freq = F)

#### Constant Variance

autoplot(m8, which = 3, nrows = 1, ncols = 1) #### Not bad

#### Cooks Distance

autoplot(m8, which = 4, nrows = 1, ncols = 1) #### We are going to drop 42 anyway.

car::vif(m8, type = "predictor") #### looks good
```

Check results

```{r}
summary(m8) #### sig at 0.01
```

### Leave One Out Cross Validation

I use the Bayesian method because I find it easier coding wise.

#### Polyarchy

```{r}
poly_varis <- gpl %>% 
  filter(polyarchy_t0 >= .42) %>% 
  select(lnseatshare, lndemocexp, lnyears, lngdppc, icap, populismavg, cow, op_strength, lnopseatshare, polyarchy_t0, polyarchy_chg) %>% 
  na.omit()

bm1 <- stan_glm(f1, data = poly_varis, refresh = 0) 
bm2 <- stan_glm(f2, data = poly_varis, refresh = 0)
loom1 <- loo(bm1, k_threshold = 0.7) 
loom2 <- loo(bm2, k_threshold = 0.7) 
loo_compare(loom1, loom2) 
```

The simple model is the better model, but its not a big difference.

#### Free and Fair election

```{r}
ff_varis <- gpl %>% 
  filter(polyarchy_t0 >= .42) %>% 
  select(lnseatshare, lndemocexp, lnyears, lngdppc, icap, populismavg, cow, op_strength, lnopseatshare, frefair_t0, frefair_chg) %>% 
  na.omit()

bm3 <- stan_glm(f3, data = ff_varis, refresh = 0)
bm4 <- stan_glm(f4, data = ff_varis, refresh = 0) 
loom3 <- loo(bm3, k_threshold = 0.7) 
loom4 <- loo(bm4,k_threshold = 0.7) 
loo_compare(loom3, loom4)
```

Simple Model performs a little better.

#### Civil Liberties

```{r}
cl_varis <- gpl %>% filter(polyarchy_t0 >= .42) %>% select(lnseatshare, lndemocexp, lnyears, lngdppc, icap, populismavg, cow, op_strength, lnopseatshare, civlib_t0, civlib_chg) %>% 
  na.omit()

bm5 <- stan_glm(f5, data = cl_varis, refresh = 0)
bm6 <- stan_glm(f6, data = cl_varis, refresh = 0)
loom5 <- loo(bm5, k_threshold = 0.7)
loom6 <- loo(bm6, k_threshold = 0.7)
loo_compare(loom5, loom6)
```

Simple Model performs a little better

#### Horizontal Accountability

```{r}
ha_varis <- gpl %>% 
  filter(polyarchy_t0 >= .42) %>% 
  select(lnseatshare, lndemocexp, lnyears, lngdppc, icap, populismavg, cow, op_strength, lnopseatshare, horacc_t0, horacc_chg) %>% 
  na.omit() 
ha_varis <- ha_varis[-40,] #### remove Hugo Chavez

bm7 <- stan_glm(f7, data = ha_varis, refresh = 0) 
bm8 <- stan_glm(f8, data = ha_varis, refresh = 0) 
loom7 <- loo(bm7, k_threshold = 0.7) 
loom8 <- loo(bm8, k_threshold = 0.7) 
loo_compare(loom7, loom8)
```

Simple Model performs a little better

In general, it seems that the theoretical models, which one would normally report in a paper are over fitted compared to the simple models, and that these simple models are likely better.

## Interactions effects: GAM, Linear, and Kernel (see Heinmuller et al. 2020).

### Polyarchy

#### Simple

```{r}
interflex(estimator = "gam", Y = "polyarchy_chg", X = "icap", D = "populismavg", Z = c("lnyears", "polyarchy_t0", "lngdppc", "lndemocexp"), data = as.matrix(poly_varis), na.rm = T, wald = T)
```

This graph shows a fairly substantial interaction effect.

```{r}
liplot1 <- interflex(estimator = "linear", Y = "polyarchy_chg", X = "icap", D = "populismavg", Z = c("lnyears", "polyarchy_t0", "lngdppc", "lndemocexp"), data = as.matrix(poly_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity")

print(liplot1$figure)
```

This confirms what we saw with the GAM.

```{r}
kiplot1 <- interflex(estimator = "kernel", Y = "polyarchy_chg", X = "icap", D = "populismavg", Z = c("lnyears", "polyarchy_t0", "lngdppc", "lndemocexp"), data = as.matrix(poly_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity")

print(kiplot1$figure)
```

There does seem to be a real interaction effect, but the moderating appears to be slightly nonlinear.

#### Full

```{r}
interflex(estimator = "gam", Y = "polyarchy_chg", X = "icap", D = "populismavg", Z = c("lnyears", "polyarchy_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(poly_varis), na.rm = T, wald = T)
```

Substantial interaction effect here.

```{r}
liplot2 <- interflex(estimator = "linear", Y = "polyarchy_chg", X = "icap", D = "populismavg", Z = c("lnyears", "polyarchy_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(poly_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity")

print(liplot2$figure)
```

Interaction confirmed here

```{r}
kiplot2 <- interflex(estimator = "kernel", Y = "polyarchy_chg", X = "icap", D = "populismavg", Z = c("lnyears", "polyarchy_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(poly_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity")

print(kiplot2$figure)
```

Fairly linear, but this accounts for lack of common support as well.

#### Free and Fair

##### Simple

```{r}
interflex(estimator = "gam", Y = "frefair_chg", X = "icap", D = "populismavg", Z = c("lnyears", "frefair_t0", "lngdppc", "lndemocexp"), data = as.matrix(ff_varis), na.rm = T, wald = T)
```

Big effect here.

```{r}
liplot3 <- interflex(estimator = "linear", Y = "frefair_chg", X = "icap", D = "populismavg", Z = c("lnyears", "frefair_t0", "lngdppc", "lndemocexp"), data = as.matrix(ff_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity")

print(liplot3$figure)
```

That effect is confirmed here, but it appears to be faily weak

```{r}
kiplot3 <- interflex(estimator = "kernel", Y = "frefair_chg", X = "icap", D = "populismavg", Z = c("lnyears", "frefair_t0", "lngdppc", "lndemocexp"), data = as.matrix(ff_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity")

print(kiplot3$figure)
```

The interaction is significant significant here.

##### Full

```{r}
interflex(estimator = "gam", Y = "frefair_chg", X = "icap", D = "populismavg", Z = c("lnyears", "frefair_t0", "lngdppc", "lnseatshare", "lndemocexp", "op_strength", "lnopseatshare"), data = as.matrix(ff_varis), na.rm = T, wald = T)
```

The interaction is a big effect again

```{r}
liplot4 <- interflex(estimator = "linear", Y = "frefair_chg", X = "icap", D = "populismavg", Z = c("lnyears", "frefair_t0", "lngdppc"), data = as.matrix(ff_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity")

print(liplot4$figure)
```

The effect is confirmed here, Likely insignificant once we get more intense models. It might be here.

```{r}
kiplot4 <- interflex(estimator = "kernel", Y = "frefair_chg", X = "icap", D = "populismavg", Z = c("lnyears", "frefair_t0", "lngdppc"), data = as.matrix(ff_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity")

print(kiplot4$figure)
```

Yeah, I do not think this effect is credibly different from 0, and it will only get worse as we add more robust models

##### Civil Liberties

###### Simple

```{r}
interflex(estimator = "gam", Y = "civlib_chg", X = "icap", D = "populismavg", Z = c("lnyears", "lndemocexp", "lngdppc", "civlib_t0"), data = as.matrix(cl_varis), na.rm = T, wald = T)
```

Another big effect here.

```{r}
liplot5 <- interflex(estimator = "linear", Y = "civlib_chg", X = "icap", D = "populismavg", Z = c("lnyears", "lndemocexp", "lngdppc", "civlib_t0"), data = as.matrix(cl_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity")

print(liplot5$figure) 
```

Really nice effect linear effect.

```{r}
kiplot5 <- interflex(estimator = "kernel", Y = "civlib_chg", X = "icap", D = "populismavg", Z = c("lnyears", "lndemocexp", "lngdppc", "civlib_t0"), data = as.matrix(cl_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity")

print(kiplot5$figure)
```

Fairly Linear and still really strong.

##### Full

```{r}
interflex(estimator = "gam", Y = "civlib_chg", X = "icap", D = "populismavg", Z = c("lnyears", "civlib_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(cl_varis), na.rm = T, wald = T)
```

Another big effect here

```{r}
liplot6 <- interflex(estimator = "linear", Y = "civlib_chg", X = "icap", D = "populismavg", Z = c("lnyears", "civlib_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(cl_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity")

print(liplot6$figure)
```

Really nice effect again. This interaction is likely significant, even when we get to more rigorous models and tests.

```{r}
kiplot6 <- interflex(estimator = "kernel", Y = "civlib_chg", X = "icap", D = "populismavg", Z = c("lnyears", "civlib_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(cl_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity")

print(kiplot6$figure) 
```

The effect is fairly linear effect again.

#### Horizontal Accountability

##### Simple

```{r}
interflex(estimator = "gam", Y = "horacc_chg", X = "icap", D = "populismavg", Z = c("lnyears", "horacc_t0", "lngdppc"), data = as.matrix(ha_varis), na.rm = T, wald = T) 
```

This effect seems smaller, but still large

```{r}
liplot7 <- interflex(estimator = "linear", Y = "horacc_chg", X = "icap", D = "populismavg", Z = c("lnyears", "horacc_t0", "lngdppc"), data = as.matrix(ha_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity")

print(liplot7$figure)
```

This effect is not significant to start out with. The rest will likely not be either.

```{r}
kiplot7 <- interflex(estimator = "kernel", Y = "horacc_chg", X = "icap", D = "populismavg", Z = c("lnyears", "horacc_t0", "lngdppc"), data = as.matrix(ha_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity")

print(kiplot7$figure)
```

#### Full

```{r}
interflex(estimator = "gam", Y = "horacc_chg", X = "icap", D = "populismavg", Z = c("lnyears", "horacc_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(ha_varis), na.rm = T, wald = T)
```

```{r}
liplot8 <- interflex(estimator = "linear", Y = "horacc_chg", X = "icap", D = "populismavg", Z = c("lnyears", "horacc_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(ha_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity")

print(liplot8$figure)

kiplot8 <- interflex(estimator = "kernel", Y = "horacc_chg", X = "icap", D = "populismavg", Z = c("lnyears", "horacc_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(ha_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity")

print(kiplot8$figure)
```

Unless Horizontal Accountability models suddenly become significant, I will not comment on them. The models from here on out are more rigorous, and they are unlikely to have significant results. If that changes, I will start to comment again, if only to investigate why the interaction became significant and to look for any methodological mistakes that might cause that change.

#### Clustering and fixed effects

All of the models have serious problems with inconstant variances, so we need to cluster by the obvious factor, country.

#### Electoral Democracy/Polyarchy

#### Simple model

```{r}
m1c <- lm_robust(f1, clusters = cow, data = poly_varis)

summary(m1c) #### sig at 0.01

liplot1c <- interflex(estimator = "linear", Y = "polyarchy_chg", X = "icap", D = "populismavg", Z = c("lnyears", "polyarchy_t0", "lngdppc", "lndemocexp"), data = as.matrix(poly_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow")

print(liplot1c$figure)
```

Really nice effect here, even with the clustered SE.

```{r}
kiplot1c <- interflex(estimator = "kernel", Y = "polyarchy_chg", X = "icap", D = "populismavg", Z = c("lnyears", "polyarchy_t0", "lngdppc", "lndemocexp"), data = as.matrix(poly_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow")

print(kiplot1c$figure)
```

Fairly linear here, and the effect remains significant

```{r}
m1fe <- lm_robust(f1, clusters = cow, fixed_effects = cow, data = poly_varis)

summary(m1fe)
```

Sig at 0.05. This is the most conservative model yet. This is likely a real effect.

```{r}
liplot1fe <- interflex(estimator = "linear", Y = "polyarchy_chg", X = "icap", D = "populismavg", Z = c("lnyears", "polyarchy_t0", "lngdppc", "lndemocexp"), data = as.matrix(poly_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow", FE = "cow")

print(liplot1fe$figure)
```

That finding is confirmed here.

```{r}
kiplot1fe <- interflex(estimator = "kernel", Y = "polyarchy_chg", X = "icap", D = "populismavg", Z = c("lnyears", "polyarchy_t0", "lngdppc", "lndemocexp"), data = as.matrix(poly_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow", FE = "cow")

print(kiplot1fe$figure)
```

This is not quite as good as the linear plot suggests, but this is still pretty good. It might be insig at 0.05, but just barely. I think this is probably good enough.

#### Full Model

```{r}
m2c <- lm_robust(f2, clusters = cow, data = poly_varis)

summary(m2c)
```

Sig at .05

```{r}
liplot2c <- interflex(estimator = "linear", Y = "polyarchy_chg", X = "icap", D = "populismavg", Z = c("lnyears", "polyarchy_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(poly_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow")

print(liplot2c$figure)
```

Really good effect again

```{r}
kiplot2c <- interflex(estimator = "kernel", Y = "polyarchy_chg", X = "icap", D = "populismavg", Z = c("lnyears", "polyarchy_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(poly_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow")

print(kiplot2c$figure)
```

Pretty good, about the same as the simple model with fixed effect.

```{r}
m2fe <- lm_robust(f2, clusters = cow, fixed_effects = cow, data = poly_varis)

summary(m2fe)
```

Sig at .1. Just barely not 0.05, but this is probably a real effect.

```{r}
liplot2fe <- interflex(estimator = "linear", Y = "polyarchy_chg", X = "icap", D = "populismavg", Z = c("lnyears", "polyarchy_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(poly_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow", FE="cow")

print(liplot2fe$figure)
```

Good model, but lets see how it looks when we do the kernel model.

```{r}
kiplot2fe <- interflex(estimator = "kernel", Y = "polyarchy_chg", X = "icap", D = "populismavg", Z = c("lnyears", "polyarchy_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(poly_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow", FE = "cow")

print(kiplot2fe$figure)
```

Really good considering the simple model did not perform as well. This might be over fitted, but it is encouraging. This actually look better than the standard linear model and might be significant at 0.05.

#### Free and Fair elections

#### Simple model

```{r}
m3c <- lm_robust(f3, clusters = cow, data = ff_varis)

summary(m3c)
```

Sig at .1, but this does not bode well for the rest of the model

```{r}
liplot3c <- interflex(estimator = "linear", Y = "frefair_chg", X = "icap", D = "populismavg", Z = c("lnyears", "frefair_t0", "lngdppc", "lndemocexp"), data = as.matrix(ff_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow")

print(liplot3c$figure)
```

Okay effect. Likely to drop to complete insignificance.

```{r}
kiplot3c <- interflex(estimator = "kernel", Y = "frefair_chg", X = "icap", D = "populismavg", Z = c("lnyears", "frefair_t0", "lngdppc", "lndemocexp"), data = as.matrix(ff_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow")

print(kiplot3c$figure)
```

This looks bad. This is liekly not a real effect.

```{r}
m3fe <- lm_robust(f3, clusters = cow, fixed_effects = cow, data = ff_varis)

summary(m3fe)
```

Not sig.

```{r}
liplot3fe <- interflex(estimator = "linear", Y = "frefair_chg", X = "icap", D = "populismavg", Z = c("lnyears", "frefair_t0", "lngdppc", "lndemocexp"), data = as.matrix(ff_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow", FE = "cow")

print(liplot3fe$figure)
```

```{r}
kiplot3fe <- interflex(estimator = "kernel", Y = "frefair_chg", X = "icap", D = "populismavg", Z = c("lnyears", "frefair_t0", "lngdppc", "lndemocexp"), data = as.matrix(ff_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow", FE = "cow")

print(kiplot3fe$figure)
```

Not good a good effect here. We cannot extrapolate from the interaction coefficient to other parts of the distribution. There might be some effect going on here, but we do not have enough evidence.

#### Full Model

```{r}
m4c <- lm_robust(f4, clusters = cow, data = ff_varis)

summary(m4c) 
```

Sig at 0.1

```{r}
liplot4c <- interflex(estimator = "linear", Y = "frefair_chg", X = "icap", D = "populismavg", Z = c("lnyears", "frefair_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(ff_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow")

print(liplot4c$figure)

kiplot4c <- interflex(estimator = "kernel", Y = "frefair_chg", X = "icap", D = "populismavg", Z = c("lnyears", "frefair_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(ff_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow")

print(kiplot4c$figure)
```

Same as the simple model. Not a good interaction effect.

```{r}
m4fe <- lm_robust(f4, fixed_effects = cow, data = ff_varis)

summary(m4fe)
```

Not sig.

```{r}
liplot4fe <- interflex(estimator = "linear", Y = "frefair_chg", X = "icap", D = "populismavg", Z = c("lnyears", "frefair_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(ff_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow", FE= "cow")

print(liplot4fe$figure)

kiplot4fe <- interflex(estimator = "kernel", Y = "frefair_chg", X = "icap", D = "populismavg", Z = c("lnyears", "frefair_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(ff_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow", FE = "cow")

print(kiplot4fe$figure)
```

This model performs even worse. Likely not a real effect.

#### Civil Liberties

#### Simple model

```{r}
m5c <- lm_robust(f5, clusters = cow, data = cl_varis)

summary(m5c) #### sig at 0.05

liplot5c <- interflex(estimator = "linear", Y = "civlib_chg", X = "icap", D = "populismavg", Z = c("lnyears", "lndemocexp", "lngdppc", "civlib_t0"), data = as.matrix(cl_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow")

print(liplot5c$figure)
```

Really good effect here. These predictors seems to be really good at predicting decline in civil liberties. Nice to see this after the last group of models.

```{r}
kiplot5c <- interflex(estimator = "kernel", Y = "civlib_chg", X = "icap", D = "populismavg", Z = c("lnyears", "lndemocexp", "lngdppc", "civlib_t0"), data = as.matrix(cl_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow")

print(kiplot5c$figure)
```

The effect stays linear and is still a strong effect.

```{r}
m5fe <- lm_robust(f5, fixed_effects = cow, data = cl_varis)

summary(m5fe)
```

Sig at .05

```{r}
liplot5fe <- interflex(estimator = "linear", Y = "civlib_chg", X = "icap", D = "populismavg", Z = c("lnyears", "lndemocexp", "lngdppc", "civlib_t0"), data = as.matrix(cl_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow", FE = "cow")

print(liplot5fe$figure)
```

Effect stays impressively robust

```{r}
kiplot5fe <- interflex(estimator = "kernel", Y = "civlib_chg", X = "icap", D = "populismavg", Z = c("lnyears", "lndemocexp", "lngdppc", "civlib_t0"), data = as.matrix(cl_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", FE = "cow")

print(kiplot5fe$figure)
```

Best model yet!

#### Full Model

```{r}
m6c <- lm_robust(f6, data = cl_varis)

summary(m6c)
```

Sig at .05

```{r}
liplot6c <- interflex(estimator = "linear", Y = "civlib_chg", X = "icap", D = "populismavg", Z = c("lnyears", "civlib_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(cl_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow")

print(liplot6c$figure)
```

Still a great effect

```{r}
kiplot6c <- interflex(estimator = "kernel", Y = "civlib_chg", X = "icap", D = "populismavg", Z = c("lnyears", "civlib_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(cl_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", FE = "cow")

print(kiplot6c$figure)
```

Stays fairly linear and keeps the strong effect

```{r}
m6fe <- lm_robust(f6, fixed_effects = cow, data = cl_varis)

summary(m6fe) 
```

Sig at .05

```{r}
liplot6fe <- interflex(estimator = "linear", Y = "civlib_chg", X = "icap", D = "populismavg", Z = c("lnyears", "civlib_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(cl_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow", FE = "cow")

print(liplot6fe$figure)
```

The effect looks good here.

```{r}
kiplot6fe <- interflex(estimator = "kernel", Y = "civlib_chg", X = "icap", D = "populismavg", Z = c("lnyears", "civlib_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(cl_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow", FE = "cow")

print(kiplot6fe$figure)
```

This looks really good. This is likely a real and linear effect, and we have the evidence to back that claim.

#### Horizontal Accountability

#### Simple model

```{r}
m7c <- lm_robust(f7, clusters = cow, data = ha_varis)

summary(m7c)
```

This is actually decent, but I bet it will tank soon.

```{r}
liplot7c <- interflex(estimator = "linear", Y = "horacc_chg", X = "icap", D = "populismavg", Z = c("lnyears", "horacc_t0", "lngdppc"), data = as.matrix(ha_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow")

print(liplot7c$figure)

kiplot7c <- interflex(estimator = "kernel", Y = "horacc_chg", X = "icap", D = "populismavg", Z = c("lnyears", "horacc_t0", "lngdppc"), data = as.matrix(ha_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow")

print(kiplot7c$figure)

m7fe <- lm_robust(f7, clusters = cow, fixed_effects = cow, data = ha_varis)

summary(m7fe)
```

Yeah, the effect significance disapears.

```{r}
liplot7fe <- interflex(estimator = "linear", Y = "horacc_chg", X = "icap", D = "populismavg", Z = c("lnyears", "horacc_t0", "lngdppc"), data = as.matrix(ha_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow", FE = "cow")

print(liplot7fe$figure)

kiplot7fe <- interflex(estimator = "kernel", Y = "horacc_chg", X = "icap", D = "populismavg", Z = c("lnyears", "horacc_t0", "lngdppc"), data = as.matrix(ha_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow", FE = "cow")

print(kiplot7fe$figure)
```

Nothing here is significant. That is an absurdly bad plot

#### Full model

```{r}
m8c <- lm_robust(f8, clusters = cow, data = ha_varis)

summary(m8c)

liplot8c <- interflex(estimator = "linear", Y = "horacc_chg", X = "icap", D = "populismavg", Z = c("lnyears", "horacc_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(ha_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow")

print(liplot8c$figure)

kiplot8c <- interflex(estimator = "kernel", Y = "horacc_chg", X = "icap", D = "populismavg", Z = c("lnyears", "horacc_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(ha_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow")

print(kiplot8c$figure)

m8fe <- lm_robust(f8, clusters = cow, fixed_effects = cow, data = ha_varis)

summary(m8fe)

liplot8fe <- interflex(estimator = "linear", Y = "horacc_chg", X = "icap", D = "populismavg", Z = c("lnyears", "horacc_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(ha_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow", FE = "cow")

print(liplot8fe$figure)

kiplot8fe <- interflex(estimator = "kernel", Y = "horacc_chg", X = "icap", D = "populismavg", Z = c("lnyears", "horacc_t0", "lngdppc", "lndemocexp", "lnseatshare", "op_strength", "lnopseatshare"), data = as.matrix(ha_varis), na.rm = T, wald = T, Dlabel = "Logged Populism", Xlabel = "Incumbent Capacity", cl = "cow", FE = "cow")

print(kiplot8fe$figure) 
```

All are insignificant.

## Tables

```{r}
descriptives <- gpl %>% 
  filter(polyarchy_t0 >= .42) %>% 
  select(lnseatshare, lndemocexp, lnyears, lngdppc, icap, populismavg, cow, op_strength, lnopseatshare, horacc_t0, horacc_chg, civlib_t0, civlib_chg, frefair_t0, frefair_chg, polyarchy_t0, polyarchy_chg)

stargazer(descriptives, title = "Descriptive Statistics") 
modelsummary::modelsummary(list(m1c, m3c, m5c, m7c)) 
modelsummary::modelsummary(list(m2c, m4c, m6c, m8c)) 
modelsummary::modelsummary(list(m1fe, m3fe, m5fe, m7fe))
modelsummary::modelsummary(list(m2fe, m4fe, m6fe, m8fe))
```

## Interaction Plots for the paper

Only the polyarchy and the civil liberties models are reported in interaction plots since they pass all the diagnositcs tests.

#### Polyarchy

##### Simple models

```{r}
final_m1c <- glm.cluster(f1, cluster = "cow", data = poly_varis)

interplot::interplot(m=final_m1c$glm_res, var2 = "icap", var1 = "populismavg") +
  geom_hline(yintercept = 0, linetype = "dashed") +
  theme_clean() +
  labs(x = "Incumbent Capacity", y = "Marginal Effect of Populism", title = "Marginal Effect of Populism on Electoral Democracy") +
  theme(plot.title = element_text(size = 10))
```

```{r}
final_m1fe <- glm.cluster(polyarchy_chg ~ populismavg + icap + lnyears + polyarchy_t0 + lngdppc + lndemocexp + populismavg:icap + factor(cow), cluster = "cow", data = poly_varis)

inter1 <- interplot::interplot(m=final_m1fe$glm_res, var2 = "icap", var1 = "populismavg", rfill = "#4f5669", linewidth = 1) +
  geom_hline(yintercept = 0, linetype = "dashed") +
  theme_clean() +
  labs(x = "Incumbent Capacity", y = "Effect of Populism", title = "Marginal Effect on Electoral Democracy", y = "Effect of Populism", x = "Incumbent Capacity Index") +
  theme(plot.title = element_text(size = 25, hjust = .5)) +
  theme(axis.text = element_text(size = 20), axis.title = element_text(size = 25)) 
```

##### Full models

```{r}
final_m2c <- glm.cluster(f2, cluster = "cow", data = poly_varis)

interplot::interplot(m=final_m2c$glm_res, var2 = "icap", var1 = "populismavg") +
  geom_hline(yintercept = 0, linetype = "dashed") +
  theme_clean() +
  labs(x = "Incumbent Capacity", y = "Marginal Effect of Populism", title = "Marginal Effect of Populism on Electoral Democracy") +
  theme(plot.title = element_text(size = 10))
```

We will want to report the clustered models in the paper, and maybe the fixed effect model depending on space.

```{r}
final_m2fe <- glm.cluster(polyarchy_chg ~ populismavg *icap + lnseatshare + lndemocexp + lnyears + lngdppc + polyarchy_t0 + op_strength + lnopseatshare + factor(cow), cluster = "cow", data = poly_varis)

inter2 <- interplot::interplot(m=final_m1fe$glm_res, var2 = "icap", var1 = "populismavg", rfill = "#157A6E", linewidth = 1) +
  geom_hline(yintercept = 0, linetype = "dashed") +
  theme_clean() +
  labs(x = "Incumbent Capacity", y = "", title = "") +
  theme(plot.title = element_text(size = 20, hjust = .5)) +
  theme(axis.text = element_text(size = 15), axis.title = element_text(size = 15)) 
```

#### Civil Liberties

##### Simple model

```{r}
final_m5c <- glm.cluster(f5, cluster = "cow", data = cl_varis)

interplot::interplot(m=final_m5c$glm_res, var2 = "icap", var1 = "populismavg") +
  geom_hline(yintercept = 0, linetype = "dashed") +
  theme_clean() +
  labs(x = "Incumbent Capacity", y = "Marginal Effect of Populism", title = "Marginal Effect of Populism on Civil Liberties") +
  theme(plot.title = element_text(size = 10))
```

Report in the appendix.

```{r}
final_m5fe <- glm.cluster(civlib_chg ~ populismavg + icap + lnyears + lngdppc + lndemocexp + civlib_t0 + populismavg:icap + factor(cow), cluster = "cow", data = cl_varis)

inter3 <- interplot::interplot(m=final_m5fe$glm_res, var2 = "icap", var1 = "populismavg", rfill = "#9DA49C", linewidth = 1) +
  geom_hline(yintercept = 0, linetype = "dashed") +
  theme_clean() +
  labs(x = "Incumbent Capacity", y = "Effect of Populism", title = "Marginal Effect on Civil Libertiies", y = "Effect of Populism", x = "Incumbent Capacity Index") +
  theme(plot.title = element_text(size = 25, hjust = .5)) +
  theme(axis.text = element_text(size = 20), axis.title = element_text(size = 25)) +
  scale_y_continuous(breaks = c(-.075, -.05, -.025, 0, .025))
```

Report in Appendix

#### Full Model

```{r}
final_m6c <- glm.cluster(f6, cluster = "cow", data = cl_varis)

interplot::interplot(m=final_m6c$glm_res, var2 = "icap", var1 = "populismavg") +
  geom_hline(yintercept = 0, linetype = "dashed") +
  theme_clean() +
  labs(x = "Incumbent Capacity", y = "Marginal Effect of Populism", title = "Marginal Effect of Populism on Civil Liberties") +
  theme(plot.title = element_text(size = 10))
```

Report in paper

```{r}
final_m6fe <- glm.cluster(civlib_chg ~ populismavg * icap + lnseatshare + lndemocexp + lnyears + lngdppc + civlib_t0 + op_strength + lnopseatshare + factor(cow), cluster = "cow", data = cl_varis)

inter4 <- interplot::interplot(m=final_m6fe$glm_res, var2 = "icap", var1 = "populismavg", rfill = "#499F68", linewidth = 1) +
  geom_hline(yintercept = 0, linetype = "dashed") +
  theme_clean() +
  labs(x = "Incumbent Capacity", y = "Effect of Populism (Full Model)", title = "") +
  theme(plot.title = element_text(size = 20, hjust = .5)) +
  theme(axis.text = element_text(size = 15), axis.title = element_text(size = 15)) +
  scale_y_continuous(breaks = c(-.075, -.05, -0.025, 0, 0.025))
```

Maybe report in paper, depending on space.

### Substantive Effects

#### Recentered and rescaled data.

The variables in the model are mean centered and re-scaled so a 1 unit change is a 2 standard deviation change.

```{r}
poly_varis_c <- poly_varis %>%
  mutate(populismavg = (populismavg- mean(populismavg))/(2*sd(populismavg)),
         icap = (icap - mean(icap))/(2*sd(icap)),  lnseatshare = (lnseatshare - mean(lnseatshare))/(2*sd(lnseatshare)),
         lndemocexp = (lndemocexp - mean(lndemocexp))/(2*sd(lndemocexp)),
         lnyears= (lnyears- mean(lnyears))/(2*sd(lnyears)),
         lngdppc = (lngdppc- mean(lngdppc))/(2*sd(lngdppc)),
         polyarchy_t0 = (polyarchy_t0- mean(polyarchy_t0))/(2*sd(polyarchy_t0)), 
         op_strength = (op_strength- mean(op_strength))/(2*sd(op_strength)),
         lnopseatshare = (lnopseatshare- mean(lnopseatshare))/(2*sd(lnopseatshare)))


cl_varis_c <- cl_varis %>%
  mutate(populismavg = (populismavg- mean(populismavg))/(2*sd(populismavg)),
         icap = (icap- mean(icap)/(2*sd(icap))),  lnseatshare = (lnseatshare- mean(lnseatshare))/(2*sd(lnseatshare)),
         lndemocexp= (lndemocexp- mean(lndemocexp))/(2*sd(lndemocexp)),
         lnyears= (lnyears- mean(lnyears))/(2*sd(lnyears)),
         lngdppc = (lngdppc- mean(lngdppc))/(2*sd(lngdppc)),
         civlib_t0 = (civlib_t0- mean(civlib_t0))/(2*sd(civlib_t0)), 
         op_strength = (op_strength- mean(op_strength))/(2*sd(op_strength)),
         lnopseatshare = (lnopseatshare- mean(lnopseatshare))/(2*sd(lnopseatshare)))

ff_varis_c <- ff_varis %>%
  mutate(populismavg = (populismavg- mean(populismavg))/(2*sd(populismavg)),
         icap = (icap- mean(icap)/(2*sd(icap))),  lnseatshare = (lnseatshare- mean(lnseatshare))/(2*sd(lnseatshare)),
         lndemocexp= (lndemocexp- mean(lndemocexp))/(2*sd(lndemocexp)),
         lnyears= (lnyears- mean(lnyears))/(2*sd(lnyears)),
         lngdppc = (lngdppc- mean(lngdppc))/(2*sd(lngdppc)),
         frefair_t0 = (frefair_t0- mean(frefair_t0))/(2*sd(frefair_t0)), 
         op_strength = (op_strength- mean(op_strength))/(2*sd(op_strength)),
         lnopseatshare = (lnopseatshare- mean(lnopseatshare))/(2*sd(lnopseatshare)))

ha_varis_c <- ha_varis %>%
  mutate(populismavg = (populismavg- mean(populismavg))/(2*sd(populismavg)),
         icap = (icap- mean(icap)/(2*sd(icap))),  lnseatshare = (lnseatshare- mean(lnseatshare))/(2*sd(lnseatshare)),
         lndemocexp= (lndemocexp- mean(lndemocexp))/(2*sd(lndemocexp)),
         lnyears= (lnyears- mean(lnyears))/(2*sd(lnyears)),
         lngdppc = (lngdppc- mean(lngdppc))/(2*sd(lngdppc)),
         horacc_t0 = (horacc_t0- mean(horacc_t0))/(2*sd(horacc_t0)), 
         op_strength = (op_strength- mean(op_strength))/(2*sd(op_strength)),
         lnopseatshare = (lnopseatshare- mean(lnopseatshare))/(2*sd(lnopseatshare)))
```

## Stan Versions

## Baseline models for paper

```{r}
base_poly <- stan_glm(polyarchy_chg ~ populismavg + icap + lnseatshare + lndemocexp + 
    lnyears + lngdppc + polyarchy_t0 + op_strength + lnopseatshare + factor(cow), data = poly_varis_c, refresh = 0)

summary(base_poly)

poly_data = data.frame(populismavg = c(0, 1, 0, 0, 0, 0, 0, 1, 0, 0 ,0), icap = c(0, 0, 1, 0, 0, 0, 0, 1, 0, 0 ,0), polyarchy_t0 = c(0,0,0,1,0,0,0,0, 0, 0 ,0), lngdppc = c(0,0,0,0,1,0,0,0, 0, 0 ,0), lndemocexp = c(0,0,0,0,0,1,0,0, 0, 0 ,0), lnyears = c(0, 0, 0, 0, 0, 0, 1, 0, 0, 0 ,0), lnseatshare = c(0,0,0,0,0,0,0,0, 1, 0 ,0),  op_strength  = c(0,0,0,0,0,0,0,0, 0, 1 ,0), lnopseatshare  = c(0,0,0,0,0,0,0,0, 0, 0 ,1), cow = "2")

base_poly <- posterior_linpred(base_poly, newdata = poly_data)
base_poly <- data.frame(base_poly)

stan.mat <- matrix(nrow = 4000, ncol = 10)
summary.mat <- matrix(nrow = 10, ncol = 3)
for (i in 1:10) {
  stan.mat[,i] <- base_poly[,i+1] - base_poly[,1]
  summary.mat[i,] <- quantile(stan.mat[,i], c(.025, .5, .975))
}

r_names <- c("Populist Discourse", "Incumbent Capacity", "Initial Democratic Quality", "Logged GDP per Capita", "Logged Democratic Experience", "Logged Tenure", "Populism X ICAP", "Logged Seat Share", "Oppostion Strength", "Logged Opp. Seat Share")

c_names <- c("lower", "mean", "upper")
colnames(summary.mat) <- c_names

summary.mat <- as.data.frame(cbind(summary.mat, r_names)) %>%
  mutate(mean = as.double(mean), lower = as.double(lower), upper = as.double(upper), type = "Electoral Democracy") %>%
  filter(r_names != "Populism X ICAP")

base_ff <- stan_glm(frefair_chg ~ populismavg + icap + lnseatshare + lndemocexp + 
    lnyears + lngdppc + frefair_t0 + op_strength + lnopseatshare + factor(cow), data = ff_varis_c, refresh = 0)

ff_data = data.frame(populismavg = c(0, 1, 0, 0, 0, 0, 0, 1, 0, 0 ,0), icap = c(0, 0, 1, 0, 0, 0, 0, 1, 0, 0 ,0), frefair_t0 = c(0,0,0,1,0,0,0,0, 0, 0 ,0), lngdppc = c(0,0,0,0,1,0,0,0, 0, 0 ,0), lndemocexp = c(0,0,0,0,0,1,0,0, 0, 0 ,0), lnyears = c(0, 0, 0, 0, 0, 0, 1, 0, 0, 0 ,0), lnseatshare = c(0,0,0,0,0,0,0,0, 1, 0 ,0),  op_strength  = c(0,0,0,0,0,0,0,0, 0, 1 ,0), lnopseatshare  = c(0,0,0,0,0,0,0,0, 0, 0 ,1), cow = "2")


base_ff <- posterior_linpred(base_ff, newdata = ff_data)
base_ff <- data.frame(base_ff)

stan.mat <- matrix(nrow = 4000, ncol = 10)
summary.mat.ff <- matrix(nrow = 10, ncol = 3)
for (i in 1:10) {
  stan.mat[,i] <- base_ff[,i+1] - base_ff[,1]
  summary.mat.ff[i,] <- quantile(stan.mat[,i], c(.025, .5, .975))
  }

colnames(summary.mat.ff) <- c_names

summary.mat.ff <- as.data.frame(cbind(summary.mat.ff, r_names)) %>%
  mutate(mean = as.double(mean), lower = as.double(lower), upper = as.double(upper), type = "Clean Elections") %>%
  filter(r_names != "Populism X ICAP")

base_cl <- stan_glm(civlib_chg ~ populismavg + icap + lnseatshare + lndemocexp + 
    lnyears + lngdppc + civlib_t0 + op_strength + lnopseatshare + factor(cow), data = cl_varis_c, refresh = 0)

cl_data = data.frame(populismavg = c(0, 1, 0, 0, 0, 0, 0, 1, 0, 0 ,0), icap = c(0, 0, 1, 0, 0, 0, 0, 1, 0, 0 ,0), civlib_t0 = c(0,0,0,1,0,0,0,0, 0, 0 ,0), lngdppc = c(0,0,0,0,1,0,0,0, 0, 0 ,0), lndemocexp = c(0,0,0,0,0,1,0,0, 0, 0 ,0), lnyears = c(0, 0, 0, 0, 0, 0, 1, 0, 0, 0 ,0), lnseatshare = c(0,0,0,0,0,0,0,0, 1, 0 ,0),  op_strength  = c(0,0,0,0,0,0,0,0, 0, 1 ,0), lnopseatshare  = c(0,0,0,0,0,0,0,0, 0, 0 ,1), cow = "2")


base_cl <- posterior_linpred(base_cl, newdata = cl_data)
base_cl <- data.frame(base_cl)

stan.mat <- matrix(nrow = 4000, ncol = 10)
summary.mat.cl <- matrix(nrow = 10, ncol = 3)
for (i in 1:10) {
  stan.mat[,i] <- base_cl[,i+1] - base_cl[,1]
  summary.mat.cl[i,] <- quantile(stan.mat[,i], c(.025, .5, .975))
  }

colnames(summary.mat.cl) <- c_names

summary.mat.cl <- as.data.frame(cbind(summary.mat.cl, r_names)) %>%
  mutate(mean = as.double(mean), lower = as.double(lower), upper = as.double(upper), type = "Civil Liberties") %>%
  filter(r_names != "Populism X ICAP")

base_ha <- stan_glm(horacc_chg ~ populismavg + icap + lnseatshare + lndemocexp + 
    lnyears + lngdppc + horacc_t0 + op_strength + lnopseatshare + factor(cow), data = ha_varis_c, refresh = 0)

ha_data = data.frame(populismavg = c(0, 1, 0, 0, 0, 0, 0, 1, 0, 0 ,0), icap = c(0, 0, 1, 0, 0, 0, 0, 1, 0, 0 ,0), horacc_t0 = c(0,0,0,1,0,0,0,0, 0, 0 ,0), lngdppc = c(0,0,0,0,1,0,0,0, 0, 0 ,0), lndemocexp = c(0,0,0,0,0,1,0,0, 0, 0 ,0), lnyears = c(0, 0, 0, 0, 0, 0, 1, 0, 0, 0 ,0), lnseatshare = c(0,0,0,0,0,0,0,0, 1, 0 ,0),  op_strength  = c(0,0,0,0,0,0,0,0, 0, 1 ,0), lnopseatshare  = c(0,0,0,0,0,0,0,0, 0, 0 ,1), cow = "2")

base_ha <- posterior_linpred(base_ha, newdata = ha_data)
base_ha <- data.frame(base_ha)

stan.mat <- matrix(nrow = 4000, ncol = 10)
summary.mat.ha <- matrix(nrow = 10, ncol = 3)
for (i in 1:10) {
  stan.mat[,i] <- base_ha[,i+1] - base_ha[,1]
  summary.mat.ha[i,] <- quantile(stan.mat[,i], c(.025, .5, .975))
  }

colnames(summary.mat.ha) <- c_names

summary.mat.ha <- as.data.frame(cbind(summary.mat.ha, r_names)) %>%
  mutate(mean = as.double(mean), lower = as.double(lower), upper = as.double(upper), type = "Horizontal Accountability") %>%
  filter(r_names != "Populism X ICAP")

mat1 <- rbind(summary.mat, summary.mat.ff)
mat2 <- rbind(mat1, summary.mat.cl)
base_mat <- rbind(mat2, summary.mat.ha) %>%
  mutate(r_names = reorder(r_names, -mean))

plot_base <- ggplot(base_mat, aes(x = r_names, y = mean, ymin = lower, ymax = upper, group = type, alpha = type, shape = type)) +
  geom_point(position = position_dodge(width = .7), size = 2.5) +
  geom_linerange(width = 0.2, position = position_dodge(width = .7), linewidth = 1) +
  coord_flip() +
  theme_bw()+
  geom_hline(yintercept = 0, color = "grey70") +
  labs(title = "Figure 1: Substantive Effects on Backsliding", x = "", y = "Predicted Effect", caption = "All Variables are mean-centered and standarized to a two standard deviation change") +
  scale_shape_manual(values=c(15,16,17,18)) +
  scale_alpha_manual(values=c(.4 ,.6, .8, 1)) +
  theme(axis.text.y = element_text(size = 10), axis.text.x = element_text(size = 10), legend.title = element_blank(), legend.position = "bottom")

ggs

```

##### Polyarchy

```{r}
poly_data_t = data.frame(populismavg = c(0, 0, 0, 1, 1, 1), icap = c(1, 0, -1, 1, 0, -1), polyarchy_t0 = 0, lngdppc = 0, lndemocexp = 0, lnyears = 0)

cl_data_t = data.frame(populismavg = c(0, 0, 0, 1, 1, 1), icap = c(1, 0, -1, 1, 0, -1), civlib_t0 = 0, lngdppc = 0, lndemocexp = 0, lnyears = 0)

sub1a <- stan_glm(f1, data = poly_varis_c, refresh = 0)

inter_poly <- posterior_linpred(sub1a, newdata = poly_data_t)
inter_poly <- data.frame(inter_poly)

stan.mat <- matrix(nrow = 4000, ncol = 3)
summary.mat <- matrix(nrow = 3, ncol = 3)
for (i in 1:3) {
  stan.mat[,i] <- inter_poly[,i+3] - inter_poly[,i]
  summary.mat[i,] <- quantile(stan.mat[,i], c(.025, .5, .975))
}

r_names <- c("Populism | ICAP = 97.5%", "Populism | ICAP = 50%", "Populism | ICAP = 2.5%")

c_names <- c("lower", "mean", "upper")
colnames(summary.mat) <- c_names

summary.mat <- as.data.frame(cbind(summary.mat, r_names)) %>%
  mutate(mean = as.double(mean), lower = as.double(lower), upper = as.double(upper), type = "Electoral Democracy")

```

##### Civil Liberties

```{r}
sub5a <- stan_glm(f5, data = cl_varis_c, refresh = 0)

inter_cl <- posterior_linpred(sub5a, newdata = cl_data_t)
inter_cl <- data.frame(inter_cl)

stan.mat.cl <- matrix(nrow = 4000, ncol = 3)
summary.mat.cl <- matrix(nrow = 3, ncol = 3)
for (i in 1:3) {
  stan.mat.cl[,i] <- inter_cl[,3+i] - inter_cl[,i]
  summary.mat.cl[i,] <- quantile(stan.mat.cl[,i], c(.025, .5, .975))
}


c_names <- c("lower", "mean", "upper")
colnames(summary.mat.cl) <- c_names

summary.mat.cl <- as.data.frame(cbind(summary.mat.cl, r_names)) %>%
  mutate(mean = as.double(mean), lower = as.double(lower), upper = as.double(upper), type = "Civil Liberties")

plot.data <- rbind(summary.mat, summary.mat.cl)

```

#### Building the plots

```{r}
plot1 <- ggplot(plot.data, aes(x = r_names, y = mean, ymin = lower, ymax = upper, group = type, color = r_names, shape = r_names)) +
  geom_point(position = position_dodge(width = 0.9), size = 7) +
  geom_linerange(width = 0.2, position = position_dodge(width = 0.9), linewidth = 2) +
  coord_flip() +
  theme_bw()+
  geom_hline(yintercept = 0, color = "grey70") +
  labs(title = "Populist Effect on Backsliding", x = "", y = "Predicted Effect", subtitle = "At different values of Incumbent Capacity") +
  scale_color_manual(values = c("#383B53", "#4F5669", "#66717E")) +
  theme(axis.text.y = element_text(size = 6.5), legend.position = "none") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 30), plot.title = element_text(hjust = , size = 40), axis.text.y = element_text(size = 40)) + 
  theme(strip.background = element_blank(), strip.text = element_text(size = 30)) +
  theme(axis.title = element_text(size = 35), plot.subtitle = element_text(size = 35)) +
  facet_wrap(~type)
```

## Predictions for Full Models

#### Polyarchy

```{r}
sub1a <- stan_glm(f2, data = poly_varis_c, refresh = 0)

poly_data = data.frame(populismavg = c(0, 1, 0, 0, 0, 0, 0, 1, 0, 0 ,0), icap = c(0, 0, 1, 0, 0, 0, 0, 1, 0, 0 ,0), polyarchy_t0 = c(0,0,0,1,0,0,0,0, 0, 0 ,0), lngdppc = c(0,0,0,0,1,0,0,0, 0, 0 ,0), lndemocexp = c(0,0,0,0,0,1,0,0, 0, 0 ,0), lnyears = c(0, 0, 0, 0, 0, 0, 1, 0, 0, 0 ,0), lnseatshare = c(0,0,0,0,0,0,0,0, 1, 0 ,0),  op_strength  = c(0,0,0,0,0,0,0,0, 0, 1 ,0), lnopseatshare  = c(0,0,0,0,0,0,0,0, 0, 0 ,1))

inter_poly <- posterior_linpred(sub1a, newdata = poly_data)
inter_poly <- data.frame(inter_poly)

stan.mat <- matrix(nrow = 4000, ncol = 10)
summary.mat <- matrix(nrow = 10, ncol = 3)
for (i in 1:10) {
  stan.mat[,i] <- inter_poly[,i+1] - inter_poly[,1]
  summary.mat[i,] <- quantile(stan.mat[,i], c(.025, .5, .975))
}

r_names <- c("Populist Discourse", "Incumbent Capacity", "Intial Democratic Quality", "Logged GDP per Capita", "Logged Democratic Quality", "Logged Tenure", "Populism X ICAP", "Logged Seat Share", "Oppostion Strength", "Logged Opp. Seat Share")

c_names <- c("lower", "mean", "upper")
colnames(summary.mat) <- c_names

summary.mat <- as.data.frame(cbind(summary.mat, r_names)) %>%
  mutate(mean = as.double(mean), lower = as.double(lower), upper = as.double(upper), type = "Electoral Democracy")
```

#### Civil Liberties

```{r}
sub5a <- stan_glm(f6, data = cl_varis_c, refresh = 0)

cl_data = data.frame(populismavg = c(0, 1, 0, 0, 0, 0, 0, 1, 0, 0 ,0), icap = c(0, 0, 1, 0, 0, 0, 0, 1, 0, 0 ,0), civlib_t0 = c(0,0,0,1,0,0,0,0, 0, 0 ,0), lngdppc = c(0,0,0,0,1,0,0,0, 0, 0 ,0), lndemocexp = c(0,0,0,0,0,1,0,0, 0, 0 ,0), lnyears = c(0, 0, 0, 0, 0, 0, 1, 0, 0, 0 ,0), lnseatshare = c(0,0,0,0,0,0,0,0, 1, 0 ,0),  op_strength  = c(0,0,0,0,0,0,0,0, 0, 1 ,0), lnopseatshare  = c(0,0,0,0,0,0,0,0, 0, 0 ,1))

inter_cl <- posterior_linpred(sub5a, newdata = cl_data)
inter_cl <- data.frame(inter_cl)

stan.mat.cl <- matrix(nrow = 4000, ncol = 10)
summary.mat.cl <- matrix(nrow = 10, ncol = 3)
for (i in 1:10) {
  stan.mat.cl[,i] <- inter_cl[,1+i] - inter_cl[,1]
  summary.mat.cl[i,] <- quantile(stan.mat.cl[,i], c(.025, .5, .975))
}

c_names <- c("lower", "mean", "upper")
colnames(summary.mat.cl) <- c_names

summary.mat.cl <- as.data.frame(cbind(summary.mat.cl, r_names)) %>%
  mutate(mean = as.double(mean), lower = as.double(lower), upper = as.double(upper), type = "Civil Liberties")

plot.data2 <- rbind(summary.mat, summary.mat.cl)
```

#### Building the plots

```{r}
plot.data2$r_names <- reorder(plot.data2$r_names, -plot.data2$mean, FUN = function(x) mean(x))

plot2 <- ggplot(plot.data2, aes(x = r_names, y = mean, ymin = lower, ymax = upper, group = type, color = type, shape = type)) +
  geom_point(position = position_dodge(width = 0.9), size = 3) +
  geom_errorbar(width = 0.2, position = position_dodge(width = 0.9), linewidth = .8) +
  coord_flip() +
  theme_bw()+
  geom_hline(yintercept = 0, color = "grey70") +
  labs(title = "", x = "Full Model Coeffecients", y = "Change from Baseline", caption = "All changes are standardized to a two standard deviation change.") +
  scale_color_manual(values = c("#499F68","#157A6E")) +
  theme(axis.text.y = element_text(size = 10),
        legend.position = "none") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 10), axis.text.y = element_text(size = 10)) +
  theme(strip.background = element_blank(), strip.text = element_blank()) +
  facet_wrap(~type)
```

Here is the same plot, but for Civil Liberties.

#### Make plots paper ready

```{r}
ggpubr::ggarrange(plot1, plot2, nrow = 2, ncol = 1)
ggpubr::ggarrange(inter2, inter3, inter1, inter4, nrow = 2, ncol = 2)
```

```{r}
ggplot(data = varis, aes(x = populismavg, y = icap)) +
  geom_point(color = "#383B53", position = position_jitter(width = 0.1, height = 0.1), size = 5) +
  theme_bw() +
  theme(legend.position = "bottom") +
  labs(title = "Populism vs. Incumbent Capacity", y = "Incumbent Capacity", x = "Populist Discourse") +
  theme(axis.text.y = element_text(size = 6.5), legend.position = "none") +
  theme(axis.text.x = element_text(hjust = 1, size = 30), plot.title = element_text(hjust = , size = 40), axis.text.y = element_text(size = 40)) + 
  theme(strip.background = element_blank(), strip.text = element_text(size = 30)) +
  theme(axis.title = element_text(size = 35), plot.subtitle = element_text(size = 35))
```
